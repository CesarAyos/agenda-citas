import{d as L,r as k,u as A,g as _,h as V,c as l,i as g,f as s,j as E,k as y,a as e,e as u,b as h,w as f,v as x,n as b,o as d,F as v,l as w,t as a,m as C,p as H}from"./app-C49SvgIa.js";import{_ as j}from"./AppLayout.vue_vue_type_script_setup_true_lang-C8bWpi3W.js";import{d as D}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CumqqboZ.js";import"./index-BNZt2pgJ.js";import"./VisuallyHidden-CXFE9zlG.js";import"./useForwardExpose-Bfb013NO.js";import"./useForwardPropsEmits-B-qC-KES.js";import"./createLucideIcon-QJOBen0w.js";const P={class:"flex h-full flex-1 flex-col gap-4 p-4"},B={class:"relative min-h-screen flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 dark:border-sidebar-border bg-white dark:bg-gray-900 p-6"},R={class:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4 border-b pb-4 dark:border-gray-700"},$={class:"relative w-full md:w-80"},U={class:"flex border-b border-gray-200 dark:border-gray-700 mb-6"},z={key:0,class:"overflow-x-auto"},G={class:"w-full text-left text-sm"},I={class:"p-3 uppercase font-medium dark:text-gray-200"},J={class:"p-3 text-blue-600 font-bold"},K={class:"p-3 font-mono dark:text-gray-300"},O={class:"p-3 font-mono dark:text-gray-300"},Q={class:"p-3 text-center"},W={key:1,class:"overflow-x-auto"},X={class:"w-full text-left text-sm"},Y={class:"p-3 uppercase font-medium dark:text-white"},Z={class:"p-3 font-bold text-green-600 dark:text-green-400"},ee={class:"p-3 font-mono dark:text-gray-300"},te={class:"p-3 text-center"},re={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4"},oe={class:"bg-white dark:bg-gray-900 rounded-xl shadow-2xl w-full max-w-md p-6 border dark:border-gray-700"},se={class:"flex justify-between items-center mb-4 border-b pb-2 dark:border-gray-700"},ne={key:0,class:"text-red-500 text-xs mt-1 font-semibold"},ae={key:0,class:"text-red-500 text-xs mt-1 font-semibold"},le={key:0,class:"text-red-500 text-xs mt-1 font-semibold"},de=["value"],ie={class:"flex justify-end gap-3 pt-4 border-t dark:border-gray-700 mt-2"},ue=["disabled"],ye=L({__name:"Dashboard",props:{citas:{},pacientesMaster:{}},setup(N){const p=N,m=k(""),c=k(!1),i=k("citas"),S=[{title:"Panel de Control - Central de Citas",href:D().url}],o=A({cedula:"",nombre_completo:"",numero_historia:"",_token:""}),M=()=>{const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");n?(o._token=n,console.log("ðŸ” Enviando formulario con token CSRF:",n.substring(0,20)+"...")):console.error("âŒ No se encontrÃ³ token CSRF en el HTML"),o.post("/admin/pacientes/registrar",{onSuccess:()=>{c.value=!1,o.reset();const t=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");t&&(o._token=t)},onError:t=>{console.error("âŒ Error en registro:",t);const r=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");r&&(o._token=r)}})},T=_(()=>p.citas?p.citas.filter(n=>{const t=m.value.toLowerCase();return n.cedula.toLowerCase().includes(t)||n.nombre.toLowerCase().includes(t)}):[]),q=_(()=>p.pacientesMaster?p.pacientesMaster.filter(n=>{const t=m.value.toLowerCase();return n.cedula.toLowerCase().includes(t)||n.nombre_completo&&n.nombre_completo.toLowerCase().includes(t)}):[]),F=()=>{const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");n&&(o._token=n),o.clearErrors(),c.value=!0};return V(()=>{const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");n?(o._token=n,console.log("âœ… Token CSRF inicializado:",n.substring(0,20)+"...")):console.warn("âš ï¸ Token CSRF no encontrado en el HTML")}),(n,t)=>(d(),l(v,null,[g(s(E),{title:"Dashboard"}),g(j,{breadcrumbs:S},{default:y(()=>[e("div",P,[e("div",B,[e("div",R,[e("div",null,[e("button",{onClick:F,class:"mt-2 bg-indigo-600 text-white px-4 py-2 rounded-lg font-bold hover:bg-indigo-700 flex items-center gap-2 transition text-sm"},[...t[8]||(t[8]=[e("span",null,"+",-1),h(" Registrar Paciente ",-1)])])]),e("div",$,[f(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>m.value=r),type:"text",placeholder:"Buscar...",class:"block w-full pl-4 pr-3 py-2 border rounded-md dark:bg-gray-800 dark:text-white"},null,512),[[x,m.value]])])]),e("div",U,[e("button",{onClick:t[1]||(t[1]=r=>i.value="citas"),class:b([i.value==="citas"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500","px-6 py-2 font-bold transition"])}," ðŸ“… Citas ",2),e("button",{onClick:t[2]||(t[2]=r=>i.value="pacientes"),class:b([i.value==="pacientes"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500","px-6 py-2 font-bold transition"])}," ðŸ‘¥ Base de Datos ",2)]),i.value==="citas"?(d(),l("div",z,[e("table",G,[t[10]||(t[10]=e("thead",{class:"bg-gray-50 dark:bg-gray-800 uppercase font-bold text-gray-700 dark:text-gray-300"},[e("tr",null,[e("th",{class:"p-3"},"Paciente"),e("th",{class:"p-3"},"NÂ° Historia"),e("th",{class:"p-3"},"CÃ©dula"),e("th",{class:"p-3"},"Departamento"),e("th",{class:"p-3 text-center"},"Acciones")])],-1)),e("tbody",null,[(d(!0),l(v,null,w(T.value,r=>(d(),l("tr",{key:r.id,class:"border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition"},[e("td",I,a(r.nombre)+" "+a(r.apellido),1),e("td",J,a(r.numero_ficha),1),e("td",K,a(r.cedula),1),e("td",O,a(r.departamento),1),e("td",Q,[g(s(C),{href:"/admin/historia/"+r.cedula,class:"bg-green-600 text-white px-3 py-1 rounded text-xs font-bold"},{default:y(()=>[...t[9]||(t[9]=[h("ðŸ“‚ Historia",-1)])]),_:1},8,["href"])])]))),128))])])])):u("",!0),i.value==="pacientes"?(d(),l("div",W,[e("table",X,[t[12]||(t[12]=e("thead",{class:"bg-gray-50 dark:bg-gray-800 uppercase font-bold text-gray-700 dark:text-gray-300"},[e("tr",null,[e("th",{class:"p-3"},"Nombre Completo"),e("th",{class:"p-3"},"NÂ° Historia"),e("th",{class:"p-3"},"CÃ©dula"),e("th",{class:"p-3 text-center"},"Acciones")])],-1)),e("tbody",null,[(d(!0),l(v,null,w(q.value,r=>(d(),l("tr",{key:r.id,class:"border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition"},[e("td",Y,a(r.nombre_completo),1),e("td",Z,a(r.numero_historia||r.numero_history),1),e("td",ee,a(r.cedula),1),e("td",te,[g(s(C),{href:"/admin/historia/"+r.cedula,class:"text-indigo-600 hover:underline font-bold transition"},{default:y(()=>[...t[11]||(t[11]=[h("Editar numero de Historia",-1)])]),_:1},8,["href"])])]))),128))])])])):u("",!0)])]),c.value?(d(),l("div",re,[e("div",oe,[e("div",se,[t[13]||(t[13]=e("h3",{class:"text-xl font-bold dark:text-white"},"Nuevo Paciente",-1)),e("button",{onClick:t[3]||(t[3]=r=>c.value=!1),class:"text-gray-400 text-2xl hover:text-gray-600 transition"},"Ã—")]),e("form",{onSubmit:H(M,["prevent"]),class:"space-y-4"},[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-xs font-bold uppercase text-gray-500 mb-1"},"CÃ©dula",-1)),f(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>s(o).cedula=r),type:"text",placeholder:"Ej: 12345678",oninput:"this.value = this.value.replace(/[^0-9]/g, '')",class:b(["w-full p-2 border rounded dark:bg-gray-800 dark:text-white outline-none focus:ring-2 focus:ring-indigo-500",{"border-red-500 ring-1 ring-red-500":s(o).errors.cedula}]),required:""},null,2),[[x,s(o).cedula]]),s(o).errors.cedula?(d(),l("p",ne,a(s(o).errors.cedula),1)):u("",!0)]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-xs font-bold uppercase text-gray-500 mb-1"},"Nombre Completo",-1)),f(e("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>s(o).nombre_completo=r),type:"text",placeholder:"Nombre del paciente",class:b(["w-full p-2 border rounded dark:bg-gray-800 dark:text-white outline-none focus:ring-2 focus:ring-indigo-500",{"border-red-500 ring-1 ring-red-500":s(o).errors.nombre_completo}]),required:""},null,2),[[x,s(o).nombre_completo]]),s(o).errors.nombre_completo?(d(),l("p",ae,a(s(o).errors.nombre_completo),1)):u("",!0)]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-xs font-bold uppercase text-gray-500 mb-1"},"NÂ° Historia",-1)),f(e("input",{"onUpdate:modelValue":t[6]||(t[6]=r=>s(o).numero_historia=r),type:"text",placeholder:"NÂ° correlativo",class:b(["w-full p-2 border rounded dark:bg-gray-800 dark:text-white outline-none focus:ring-2 focus:ring-indigo-500",{"border-red-500 ring-1 ring-red-500":s(o).errors.numero_historia}]),required:""},null,2),[[x,s(o).numero_historia]]),s(o).errors.numero_historia?(d(),l("p",le,a(s(o).errors.numero_historia),1)):u("",!0)]),e("input",{type:"hidden",name:"_token",value:s(o)._token},null,8,de),e("div",ie,[e("button",{type:"button",onClick:t[7]||(t[7]=r=>c.value=!1),class:"text-gray-500 hover:text-gray-700 font-medium px-4 py-2 transition"},"Cancelar"),e("button",{type:"submit",disabled:s(o).processing,class:"bg-indigo-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-indigo-700 disabled:opacity-50 transition shadow-md"},a(s(o).processing?"Guardando...":"Guardar Paciente"),9,ue)])],32)])])):u("",!0)]),_:1})],64))}});export{ye as default};
